Should run in O(n!)

5 10
a b 2
a c 9
a d 10
a e 7
b c 6
b d 4
b e 3
c d 8
c e 5
d e 1

21
a b d e c a

/////
9 36
a b 19
a c 15
a d 112
a e 10
a f 39
a g 42
a h 37
a i 42
b c 86
b d 50
b e 81
b f 33
b g 51
b h 8
b i 18
c d 66
c e 58
c f 58
c g 69
c h 104
c i 20
d e 80
d f 47
d g 69
d h 20
d i 17
e f 45
e g 78
e h 5
e i 101
f g 34
f h 75
f i 7
g h 37
g i 77
h i 43

128
a e h b f i d g c a

///////
15 105
a b 72
a c 45
a d 33
a e 87
a f 6
a g 41
a h 96
a i 55
a j 62
a k 74
a l 51
a m 68
a n 39
a o 9
b c 9
b d 64
b e 88
b f 51
b g 79
b h 5
b i 97
b j 43
b k 50
b l 72
b m 80
b n 46
b o 12
c d 7
c e 31
c f 7
c g 36
c h 56
c i 62
c j 8
c k 83
c l 90
c m 47
c n 38
c o 87
d e 12
d f 41
d g 71
d h 58
d i 66
d j 34
d k 13
d l 49
d m 88
d n 30
d o 10
e f 10
e g 44
e h 37
e i 85
e j 55
e k 67
e l 10
e m 38
e n 51
e o 97
f g 6
f h 39
f i 88
f j 7
f k 54
f l 60
f m 42
f n 72
f o 93
g h 13
g i 81
g j 45
g k 14
g l 55
g m 77
g n 35
g o 61
h i 5
h j 5
h k 47
h l 91
h m 53
h n 80
h o 99
i j 8
i k 94
i l 36
i m 59
i n 12
i o 48
j k 12
j l 83
j m 57
j n 70
j o 41
k l 10
k m 65
k n 90
k o 54
l m 11
l n 73
l o 37
m n 11
m o 61
n o 9

134
a f g k j i h b c d e l m n o a

/////
20 190
a b 62
a c 55
a d 72
a e 40
a f 88
a g 6
a h 51
a i 77
a j 90
a k 36
a l 63
a m 12
a n 68
a o 84
a p 47
a q 39
a r 59
a s 41
a t 53
b c 32
b d 91
b e 47
b f 76
b g 52
b h 88
b i 45
b j 63
b k 36
b l 54
b m 71
b n 62
b o 79
b p 84
b q 51
b r 69
b s 74
b t 14
c d 81
c e 65
c f 90
c g 9
c h 59
c i 72
c j 33
c k 47
c l 38
c m 8
c n 64
c o 77
c p 43
c q 88
c r 49
c s 91
c t 36
d e 44
d f 97
d g 35
d h 66
d i 57
d j 12
d k 80
d l 38
d m 62
d n 9
d o 55
d p 69
d q 77
d r 51
d s 42
d t 68
e f 83
e g 38
e h 97
e i 49
e j 73
e k 10
e l 41
e m 53
e n 75
e o 32
e p 8
e q 92
e r 46
e s 85
e t 59
f g 6
f h 93
f i 87
f j 55
f k 67
f l 72
f m 44
f n 68
f o 61
f p 13
f q 81
f r 47
f s 79
f t 58
g h 36
g i 91
g j 48
g k 52
g l 73
g m 9
g n 38
g o 82
g p 44
g q 99
g r 51
g s 68
g t 63
h i 92
h j 77
h k 55
h l 80
h m 35
h n 83
h o 58
h p 37
h q 10
h r 49
h s 76
h t 62
i j 95
i k 67
i l 74
i m 39
i n 81
i o 53
i p 42
i q 88
i r 11
i s 6
i t 70
j k 34
j l 91
j m 68
j n 77
j o 41
j p 50
j q 87
j r 12
j s 33
j t 46
k l 62
k m 37
k n 84
k o 55
k p 13
k q 90
k r 48
k s 79
k t 35
l m 11
l n 39
l o 87
l p 58
l q 71
l r 40
l s 92
l t 54
m n 12
m o 82
m p 45
m q 76
m r 49
m s 70
m t 61
n o 10
n p 88
n q 47
n r 35
n s 93
n t 52
o p 40
o q 77
o r 66
o s 91
o t 9
p q 63
p r 74
p s 46
p t 11
q r 12
q s 83
q t 51
r s 5
r t 87
s t 14

317
a g f p e k h q r i s j d n o t b c l m a